---
import { Image } from "astro:assets";
import type { ImageMetadata } from "astro";

interface Props {
  title: string;
  description: string;
  image: ImageMetadata;
  href: string;
  showIcon?: boolean;
  isExternal?: boolean;
  class?: string;
}

const {
  title,
  description,
  image,
  href,
  showIcon = false,
  isExternal = false,
  class: className = "",
} = Astro.props;
---

<article
  class={`product-card product-card-shine overflow-hidden relative h-full flex flex-col ${className}`}
>
  <!-- Image Container -->
  <div
    class="product-card-image-container relative w-full flex-1 min-h-[637px] overflow-hidden"
  >
    <!-- Background Image -->
    <Image
      src={image}
      alt={title}
      class="w-full h-full object-cover transition-transform duration-500 hover:scale-105"
      loading="lazy"
    />

    <!-- Dark Overlay for better text contrast -->
    <div
      class="absolute inset-0 bg-gradient-to-t from-black/80 via-black/40 to-transparent"
    >
    </div>

    <!-- Content Overlay - Bottom Left -->
    <div
      class="absolute inset-0 flex flex-col justify-end p-4 sm:p-6 md:p-8 text-white"
    >
      <div class="max-w-full">
        <!-- Title -->
        <h3
          class="product-card-title text-2xl sm:text-3xl md:text-4xl font-bold mb-2 sm:mb-3"
        >
          {title}
        </h3>

        <!-- Description -->
        <p
          class="product-card-description text-sm sm:text-base md:text-lg mb-4 sm:mb-6 max-w-md opacity-95"
        >
          {description}
        </p>

        <!-- Button -->
        <a
          href={href}
          class="product-card-button inline-flex items-center justify-center button-text rounded-md cursor-pointer transition-all duration-300 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-white relative overflow-hidden button-shine px-4 py-2 sm:px-6 sm:py-3 border-2 border-white text-white hover:bg-white hover:text-gray-900 bg-transparent"
          target={isExternal ? "_blank" : undefined}
          rel={isExternal ? "noopener noreferrer" : undefined}
          data-astro-prefetch={isExternal ? undefined : "hover"}
        >
          Learn more â†’
        </a>
      </div>
    </div>
  </div>
</article>

<style>
  /* Product Card Container - Figma Properties */
  .product-card {
    background-color: #ffffff;
    border-radius: 13.81px;
    border: 0.86px solid rgba(0, 0, 0, 0.1); /* #000000 with 10% opacity */
    /* First shadow: X: 0, Y: 5.18px, Blur: 10.36px, Spread: 0, Color: #000000, Opacity: 3% */
    /* Second shadow: X: 0, Y: 3.45px, Blur: 6.91px, Spread: 0, Color: #000000, Opacity: 2% */
    box-shadow:
      0 5.18px 10.36px 0 rgba(0, 0, 0, 0.03),
      0 3.45px 6.91px 0 rgba(0, 0, 0, 0.02);
    transition:
      transform 0.3s cubic-bezier(0.4, 0, 0.2, 1),
      box-shadow 0.3s cubic-bezier(0.4, 0, 0.2, 1);
    min-height: 637px; /* Figma height: 636.74px */
    display: flex;
    flex-direction: column;
  }

  /* Metallic shine effect for product cards - same as buttons */
  .product-card-shine::before {
    content: '';
    position: absolute;
    top: 0;
    left: -100%;
    width: 100%;
    height: 100%;
    background: linear-gradient(
      90deg,
      transparent,
      rgba(255, 255, 255, 0.4),
      rgba(255, 255, 255, 0.6),
      rgba(255, 255, 255, 0.4),
      transparent
    );
    transition: left 0.6s cubic-bezier(0.4, 0, 0.2, 1);
    pointer-events: none;
    z-index: 10;
    border-radius: 13.81px; /* Match card border radius */
  }

  .product-card-shine:hover::before {
    left: 100%;
  }

  .product-card:hover {
    transform: translateY(-4px);
    /* Enhanced shadows on hover while maintaining Figma base shadows */
    box-shadow:
      0 5.18px 10.36px 0 rgba(0, 0, 0, 0.03),
      0 3.45px 6.91px 0 rgba(0, 0, 0, 0.02),
      0 20px 25px -5px rgba(0, 0, 0, 0.1),
      0 10px 10px -5px rgba(0, 0, 0, 0.04);
  }

  /* Product Card Title Typography */
  .product-card-title {
    font-family: "Inter", system-ui, sans-serif;
    font-weight: 600; /* Semi Bold */
    font-style: normal;
    line-height: 120%;
    letter-spacing: -0.01em; /* -1% */
    color: #ffffff;
  }

  /* Product Card Description Typography */
  .product-card-description {
    font-family: "Inter", system-ui, sans-serif;
    font-weight: 400; /* Regular */
    font-style: normal;
    line-height: 150%;
    letter-spacing: -0.002em; /* -0.2% */
    color: #ffffff;
  }

  /* Product Card Icon */
  .product-card-icon {
    transition: transform 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  }

  .product-card:hover .product-card-icon {
    transform: scale(1.1);
  }

  /* Image container respects card border radius */
  .product-card-image-container {
    border-radius: 13.81px;
    flex: 1;
    min-height: 637px; /* Figma height: 636.74px */
  }

  /* Product Card Button Styles */
  .product-card-button {
    background-color: transparent;
    border-color: #ffffff;
    color: #ffffff;
  }

  .product-card-button:hover {
    background-color: #ffffff;
    color: #1f2937; /* gray-900 */
  }

  /* Metallic shine effect for product card buttons */
  .product-card-button.button-shine::before {
    background: linear-gradient(
      90deg,
      transparent,
      rgba(255, 255, 255, 0.3),
      rgba(255, 255, 255, 0.5),
      rgba(255, 255, 255, 0.3),
      transparent
    );
  }

  .product-card-button:hover.button-shine::before {
    background: linear-gradient(
      90deg,
      transparent,
      rgba(0, 0, 0, 0.2),
      rgba(0, 0, 0, 0.3),
      rgba(0, 0, 0, 0.2),
      transparent
    );
  }
</style>
